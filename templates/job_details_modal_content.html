<h2>Job Details</h2>
<div class="job-details-compact">
    <!-- Group 1: Property, Tenant & Access Details -->
    <div class="group-card property-group-card">
        <div class="group-content">
            <div class="group-item">
                <span class="item-icon">üìç</span>
                <div class="item-content">
                    <div class="primary-info">{{ job.property.address }}</div>
                </div>
            </div>
            <div class="group-item">
                <span class="item-icon">üë§</span>
                <div class="item-content">
                    {% if job.arrival_date %}
                    <div class="primary-info">Arrives: {{ job.arrival_date.strftime(DATETIME_FORMATS['DATE_FORMAT']) }}</div>
                    {% else %}
                    <div class="primary-info">Arrives: Not specified</div>
                    {% endif %}
                    {% if job.arrival_time_only %}
                    <div class="secondary-info">Time: {{ job.arrival_time_only.strftime(DATETIME_FORMATS['TIME_FORMAT']) }}</div>
                    {% else %}
                    <div class="secondary-info">Time: Not specified</div>
                    {% endif %}
                </div>
            </div>
            {% if job.property.access_notes %}
            <div class="group-item">
                <span class="item-icon">üîë</span>
                <div class="item-content">
                    <div class="primary-info">{{ job.property.access_notes }}</div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Group 2: Time, Duration & Description -->
    <div class="group-card schedule-group-card">
        <div class="group-content">
            <div class="group-item">
                <span class="item-icon">üïê</span>
                <div class="item-content">
                    <div class="primary-info">Start: {{ job.time.strftime(DATETIME_FORMATS['TIME_FORMAT']) }}</div>
                    <div class="secondary-info">End: {{ job.end_time.strftime(DATETIME_FORMATS['TIME_FORMAT']) }} ({{ job.duration }})</div>
                </div>
            </div>
            {% if job.arrival_datetime %}
            {% endif %}
            <div class="group-item">
                <span class="item-icon">üìù</span>
                <div class="item-content">
                    <div class="primary-info">{{ job.description }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Group 3: Teams & Cleaners -->
    <div class="group-card assignment-group-card">
        <div class="group-content">
            <div class="group-item">
                <span class="item-icon">üë•</span>
                <div class="item-content">
                    <div class="primary-info">
                        {% if job_teams %}
                            {% for team in job_teams %}
                                <span class="assignment-tag">{{ team.name }}</span>
                            {% endfor %}
                        {% else %}
                            <span class="no-assignment">No teams assigned</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="group-item">
                <span class="item-icon">üßπ</span>
                <div class="item-content">
                    <div class="primary-info">
                        {% if job_cleaners %}
                            {% for cleaner in job_cleaners %}
                                <span class="assignment-tag">{{ cleaner.username }}</span>
                            {% endfor %}
                        {% else %}
                            <span class="no-assignment">No cleaners assigned</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status & Actions -->
    <div class="status-actions">
        <div class="job-statuses">
            {% include 'job_status_fragment.html' %}
            {% if job.arrival_datetime and job.arrival_datetime.date() == job.date %}
            <div class="job-status-badge red">Same Day Arrival</div>
            {% elif job.arrival_datetime and (job.arrival_datetime.date() - job.date).days == 1 %}
            <div class="job-status-badge yellow">Next Day Arrival</div>
            {% endif %}
            {% if job.id in back_to_back_job_ids %}
            <div class="job-status-badge red">Back to Back</div>
            {% endif %}
        </div>
        {% if current_user.role == 'owner' %}
            <button hx-get="{{ url_for('job.update_job', job_id=job.id) }}"
                hx-target="#job-modal-content"
                hx-swap="innerHTML"
                hx-trigger="click"
            class="button edit-button">
                ‚úèÔ∏è Edit
            </button>
        {% endif %}
    </div>
</div>