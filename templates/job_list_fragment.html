<div class="job-list" id="job-list" {% if is_oob_swap %}hx-swap-oob="outerHTML"{% endif %} data-selected-date="{{ selected_date }}">
    {% if jobs %}
        {% if show_date_dividers %}
            {# Group jobs by date with dividers #}
            {% set ns = namespace(current_date=None, count=0) %}
            {% for job in jobs %}
                {% set job_date = job.display_datetime.date() %}
                {% if ns.current_date != job_date %}
                    {% if ns.current_date is not none %}
                        </div> {# Close previous date group #}
                    {% endif %}
                    <div class="date-group" data-date="{{ job_date }}">
                        <div class="date-divider">
                            <span class="date-label">
                                {{ job_date.strftime(DATETIME_FORMATS['DATE_FORMAT_JOBS_PY'] if DATETIME_FORMATS and 'DATE_FORMAT_JOBS_PY' in DATETIME_FORMATS else "%d %B %Y") }}
                            </span>
                        </div>
                    {% set ns.current_date = job_date %}
                {% endif %}
                {% with view_type=view_type %}
                {% include 'job_card.html' %}
                {% endwith %}
            {% endfor %}
            {% if ns.current_date is not none %}
                </div> {# Close last date group #}
            {% endif %}
        {% else %}
            {# Original flat list without dividers #}
            {% for job in jobs %}
                {% with view_type=view_type %}
                {% include 'job_card.html' %}
                {% endwith %}
            {% endfor %}
        {% endif %}
    {% else %}
        <p class="no-jobs-message">No jobs found for the selected filters.</p>
    {% endif %}
</div>
<script>
    {% if errors %}
        // Display errors using Toastr
        {% for error in errors %}
            window.showError("{{ error }}");
        {% endfor %}
    {% endif %}
</script>