<div data-view-type="{{ view_type }}" class="job-card
{% if job.description %}red-outline
{% endif %}
{% if job.arrival_datetime and job.arrival_datetime.date() == job.date %}arrival-same-day
{% elif job.arrival_datetime and (job.arrival_datetime.date() - job.date).days == 1 %}arrival-next-day
{% endif %}
{% if job.is_complete %}completed
{% endif %}" id="job-{{ job.id }}" data-job-id="{{ job.id }}">
    <span class="job-close-button small-icon close-button" data-job-id="{{ job.id }}"
    hx-delete="{{ url_for('job.delete_job', job_id=job.id, view_type=view_type) }}"
    {% if view_type == 'team' %}
    hx-target="#team-columns-container"
    hx-swap="outerHTML"
    {% else %}
    hx-target="#job-list"
    hx-swap="outerHTML"
    {% endif %}
    hx-confirm="Are you sure you want to delete this job? This action cannot be undone."
    style="cursor: pointer">&times;</span>
    
    <div class="job-card-details">
        <div class="job-info">
            <p><strong>Time:</strong> {{ job.time.strftime(DATETIME_FORMATS['TIME_FORMAT']) }}</p>
            <p><strong>Ends:</strong> {{ job.end_time.strftime(DATETIME_FORMATS['TIME_FORMAT']) }} ({{ job.duration }})</p>
            <p><strong>Property Address:</strong> {{ job.property.address }}</p>
        </div>
        <div class="job-status-actions">
            {% if current_user.is_authenticated and current_user.role in ['admin', 'supervisor'] %}
            <div class="job-actions" id="job-actions-{{ job.id }}">
                <button hx-post="{{ url_for('job.update_job_status', job_id=job.id) }}?date={{ selected_date }}"
                        hx-vals='{"is_complete": "{{ not job.is_complete }}" }'
                        hx-target="#job-{{ job.id }}"
                        hx-swap="outerHTML"
                        class="button">
                    <span id="job-update-status-{{ job.id }}">{% if job.is_complete %}Mark Pending{% else %}Mark Complete{% endif %}</span>
                </button>
                <button hx-get="{{ url_for('job.get_job_details', job_id=job.id, view_type=view_type) }}"
                        hx-target="#job-modal-content"
                        hx-trigger="click"
                        hx-on--after-request="document.getElementById('job-modal').style.display='block'"
                        class="button">
                    View Details
                </button>
            </div>
            {% endif %}
            <div class="job-statuses">
                {% if job.arrival_datetime and job.arrival_datetime.date() == job.date %}
                <div class="job-status-badge red">Same Day Arrival</div>
                {% elif job.arrival_datetime and (job.arrival_datetime.date() - job.date).days == 1 %}
                <div class="job-status-badge yellow">Next Day Arrival</div>
                {% endif %}
                {% if job.description %}
                <div class="job-status-badge red">See Notes</div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

