[pytest]
# Docker testing configuration
# This config is for e2e tests to be executed on the docker configuration using PostgreSQL and S3/MinIO in the docker network

# Test discovery - only run e2e tests
testpaths = tests/e2e
pythonpath = .
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Exclude tests
norecursedirs = docker, integration

# Addopts for Docker tests
addopts = 
    --tb=short
    --strict-markers
    -v
    --disable-warnings

# Markers
markers =
    slow: marks tests as slow
    no_csrf: tests that require CSRF protection disabled
    playwright: tests that use Playwright browser automation
    db_reset: marks tests that require database reset after execution
# Configuration for Docker environment
env =
    FLASK_ENV = testing
    STORAGE_PROVIDER = s3
    DATABASE_URL = postgresql://cleanit_user@localhost:5432/cleanit
    SECRET_KEY = test-secret-key-for-docker-tests
    S3_BUCKET = cleanit-media
    AWS_REGION = us-east-1
    AWS_ACCESS_KEY_ID = minioadmin
    AWS_SECRET_ACCESS_KEY = minioadmin
    S3_ENDPOINT_URL = http://localhost:9000
    S3_USE_HTTPS = false
    S3_VERIFY_SSL = false
    S3_PUBLIC_HOST = localhost
    S3_PUBLIC_PORT = 9000
    APP_TIMEZONE = Australia/Melbourne

# Require e2e marker for all tests
# This ensures tests won't run accidentally without Docker
required_markers = e2e

# Test execution
xfail_strict = true
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

